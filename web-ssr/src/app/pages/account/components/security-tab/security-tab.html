<div class="max-w-2xl mx-auto animate-slide-up space-y-6">
  <!-- Messages -->
  @if (successMessage()) {
  <div
    class="bg-green-50 border-l-4 border-green-400 p-4 rounded-lg animate-fade-in"
  >
    <p class="text-sm text-green-700">{{ successMessage() }}</p>
  </div>
  } @if (errorMessage()) {
  <div
    class="bg-red-50 border-l-4 border-red-400 p-4 rounded-lg animate-fade-in"
  >
    <p class="text-sm text-red-700">{{ errorMessage() }}</p>
  </div>
  }

  <!-- Cambiar contraseña -->
  <div class="bg-white rounded-xl shadow-md p-6">
    <h3
      class="text-lg font-semibold text-slate-900 mb-4"
      data-i18n="account.change_password"
    >
      Cambiar contraseña
    </h3>
    <form
      (submit)="$event.preventDefault(); changePassword()"
      class="space-y-4"
    >
      <div>
        <label
          for="current-password"
          class="block text-sm font-medium text-slate-700 mb-2"
          data-i18n="account.current_password"
        >
          Contraseña actual
        </label>
        <input
          id="current-password"
          type="password"
          [value]="passwordForm().currentPassword"
          (input)="updatePasswordField('currentPassword', $any($event.target).value)"
          [disabled]="isChangingPassword()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors"
        />
      </div>
      <div>
        <label
          for="new-password"
          class="block text-sm font-medium text-slate-700 mb-2"
          data-i18n="account.new_password"
        >
          Nueva contraseña
        </label>
        <input
          id="new-password"
          type="password"
          [value]="passwordForm().newPassword"
          (input)="updatePasswordField('newPassword', $any($event.target).value)"
          [disabled]="isChangingPassword()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors"
        />
        <p class="text-xs text-slate-500 mt-1">Mínimo 8 caracteres</p>
      </div>
      <div>
        <label
          for="confirm-password"
          class="block text-sm font-medium text-slate-700 mb-2"
          data-i18n="account.confirm_password"
        >
          Confirmar contraseña
        </label>
        <input
          id="confirm-password"
          type="password"
          [value]="passwordForm().confirmPassword"
          (input)="updatePasswordField('confirmPassword', $any($event.target).value)"
          [disabled]="isChangingPassword()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors"
        />
      </div>
      <button
        type="submit"
        [disabled]="isChangingPassword()"
        class="w-full md:w-auto bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
      >
        @if (isChangingPassword()) {
        <svg
          class="animate-spin h-5 w-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
        Actualizando... } @else {
        <span data-i18n="account.update_password">Actualizar contraseña</span>
        }
      </button>
    </form>
  </div>

  <!-- Sesiones activas -->
  <div class="bg-white rounded-xl shadow-md p-6">
    <h3
      class="text-lg font-semibold text-slate-900 mb-4"
      data-i18n="account.active_sessions"
    >
      Sesiones activas
    </h3>
    <div class="space-y-4">
      @for (session of sessions(); track session.id) {
      <div
        class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
      >
        <div class="flex items-center gap-3 flex-1">
          <div
            class="h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-xl"
          >
            {{ getDeviceIcon(session.device) }}
          </div>
          <div class="flex-1 min-w-0">
            <p class="font-medium text-slate-900 truncate">
              {{ session.device }} • {{ session.browser }}
            </p>
            <p class="text-sm text-slate-600 truncate">
              {{ session.location }} • {{ formatLastActive(session.lastActive)
              }}
            </p>
            <p class="text-xs text-slate-400 truncate">{{ session.ip }}</p>
          </div>
        </div>
        @if (session.isCurrentSession) {
        <span
          class="text-xs bg-green-100 text-green-800 px-3 py-1 rounded-full font-medium whitespace-nowrap ml-3"
        >
          Actual
        </span>
        } @else {
        <button
          (click)="revokeSession(session.id)"
          class="text-sm text-red-600 hover:text-red-700 font-medium whitespace-nowrap ml-3 transition-colors"
        >
          Cerrar
        </button>
        }
      </div>
      } @if ((sessions()?.length ?? 0) === 0) {
      <p class="text-sm text-slate-500 text-center py-4">
        No hay sesiones activas
      </p>
      }
    </div>
  </div>

  <!-- Cerrar sesión -->
  <div class="bg-white rounded-xl shadow-md p-6 border-2 border-red-100">
    <h3
      class="text-lg font-semibold text-slate-900 mb-2"
      data-i18n="account.logout_title"
    >
      Cerrar sesión
    </h3>
    <p class="text-sm text-slate-600 mb-4" data-i18n="account.logout_text">
      Cerrar sesión en este dispositivo
    </p>
    <button
      (click)="logout()"
      class="bg-red-50 text-red-600 px-6 py-2 rounded-lg font-semibold hover:bg-red-100 transition-all"
    >
      <span data-i18n="account.logout_button">Cerrar sesión</span>
    </button>
  </div>
</div>
